(this.webpackJsonppush_server_client=this.webpackJsonppush_server_client||[]).push([[0],{58:function(e,t,a){e.exports=a(69)},63:function(e,t,a){},64:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},65:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(9),i=a.n(o),c=(a(63),a(64),a(65),a(10)),l=a(11),s=a(112),u=a(116),g=a(117),p=a(118),m=a(70),d=a(124),h=a(120),f=a(122),v=a(119),b=a(115),E=a(29),y=a(110),w=a(121);function S(){var e=Object(n.useState)(""),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(""),l=Object(c.a)(i,2),s=l[0],u=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{variant:"h6",gutterBottom:!0},"Add public VAPID key & Server URL"),r.a.createElement(y.a,{container:!0,spacing:3},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(w.a,{required:!0,id:"vapidkey",name:"vapidkey",label:"Public VAPID key",multiline:!0,fullWidth:!0,value:a,onChange:function(e){o(e.target.value),localStorage.setItem("Vapid",e.target.value)},autoComplete:"Public VAPID key",helperText:""===a?"Empty!":" "})),r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(w.a,{required:!0,id:"serverurl",name:"serverurl",label:"Server URL",fullWidth:!0,value:s,onChange:function(e){u(e.target.value),localStorage.setItem("Url",e.target.value)},autoComplete:"Server URL",helperText:""===s?"Empty!":" "}))))}function k(){var e=Object(n.useState)(localStorage.getItem("subs")),t=Object(c.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(0),l=Object(c.a)(i,2),s=l[0],u=l[1];return Object(n.useEffect)((function(){o(localStorage.getItem("subs")),null===a&&(u(s+1),console.log(s))}),[s]),r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{variant:"h6",gutterBottom:!0},"Subscription object"),r.a.createElement(y.a,{container:!0,spacing:3},r.a.createElement(y.a,{item:!0,xs:12},r.a.createElement(E.a,{key:s,style:{wordBreak:"break-all"}},a))))}a(111),a(113),a(114),Object(s.a)((function(e){return{listItem:{padding:e.spacing(1,0)},total:{fontWeight:700},title:{marginTop:e.spacing(2)}}}));var j=localStorage.getItem("Url");function O(e){return fetch("".concat(j,"/notifications/subscribe"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}function I(){var e=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length),r=0;r<a.length;++r)n[r]=a.charCodeAt(r);return n}(localStorage.getItem("Vapid"));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.pushManager?t.pushManager.getSubscription().then((function(a){null===a?(console.log("No subscription detected, make a request."),t.pushManager.subscribe({applicationServerKey:e,userVisibleOnly:!0}).then((function(e){console.log("New subscription added."),O(e),localStorage.setItem("subs",JSON.stringify(e))})).catch((function(e){"granted"!==Notification.permission?console.log("Permission was not granted."):console.error("An error ocurred during the subscription process.",e)}))):(localStorage.setItem("subs",JSON.stringify(a)),console.log("Existed subscription detected."),O(a),console.log(localStorage.getItem("subs")))})):console.log("Push manager unavailable.")})).catch((function(e){console.error("An error ocurred during Service Worker registration.",e)}))}function N(){return r.a.createElement(E.a,{variant:"body2",color:"textSecondary",align:"center"},"Made with \u2661 by ",r.a.createElement(b.a,{color:"inherit",href:"https://www.linkedin.com/in/dhananjaypurohit/"},"Dhananjay Purohit")," ",".")}var x=Object(s.a)((function(e){return{appBar:{position:"relative"},layout:Object(l.a)({width:"auto",marginLeft:e.spacing(2),marginRight:e.spacing(2)},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(l.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2)},e.breakpoints.up(600+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),stepper:{padding:e.spacing(3,0,5)},buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)},title:{flexGrow:1}}})),A=["VAPID key & Server URL","Generated Subscription object"];function P(){var e=x(),t=r.a.useState(0),a=Object(c.a)(t,2),n=a[0],o=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,null),r.a.createElement(g.a,{position:"static",color:"default",className:e.appBar},r.a.createElement(p.a,null,r.a.createElement(E.a,{variant:"h6",color:"inherit",className:e.title,noWrap:!0},"Push Notifications demo"),r.a.createElement(v.a,{color:"inherit",href:"https://github.com/DhananjayPurohit/push-client/",target:"_blank"},"Github"),r.a.createElement(v.a,{color:"inherit",href:"https://medium.com/@dhananjaypurohit7/build-a-server-for-sending-web-push-notifications-42367d9fafa8",target:"_blank"},"Docs"))),r.a.createElement("main",{className:e.layout},r.a.createElement(m.a,{className:e.paper},r.a.createElement(E.a,{component:"h1",variant:"h4",align:"center"},"Check push notification server"),r.a.createElement(d.a,{activeStep:n,className:e.stepper},A.map((function(e){return r.a.createElement(h.a,{key:e},r.a.createElement(f.a,null,e))}))),r.a.createElement(r.a.Fragment,null,r.a.createElement(r.a.Fragment,null,0===n?r.a.createElement(S,null):r.a.createElement(k,null),r.a.createElement("div",{className:e.buttons},r.a.createElement(v.a,{variant:"contained",color:"primary",onClick:n===A.length-1?function(){o(n-1),localStorage.clear()}:function(){null!==localStorage.getItem("Vapid")&&null!==localStorage.getItem("Url")&&(o(n+1),I())},className:e.button},n===A.length-1?"Back":"Next"))))),r.a.createElement(N,null)))}var W=function(){return r.a.createElement("div",null,r.a.createElement(P,null))},C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function U(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){var t=new URL("/push-client",window.location.href);if(t.origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat(t.origin,"/push-client/").concat("service-worker.js");C?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):U(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):U(a,e)}))}}(),localStorage.clear()}},[[58,1,2]]]);
//# sourceMappingURL=main.22f7b72b.chunk.js.map